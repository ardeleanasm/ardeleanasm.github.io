<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Monte Carlo Integration</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../css/blogstyle.css" />
</head>
<body>
<div class="header"> <a href="../blog.html">&larr; Posts</a> </div>
<header>
<h1 class="title">Monte Carlo Integration</h1>
</header>
<div class="header">
<a href="../blog.html">← Posts</a>
</div>
<div class="header">
<a href="../blog.html">← Posts</a>
</div>
<p>Monte Carlo methods are numerical techniques which rely on random sampling to approximate their results. Thus, in Monte Carlo integration, the process of numerical estimation of integrals is applied. Considering we want to integrate a one-dimensional function <span class="math inline"><em>f</em>(<em>x</em>)</span> from <span class="math inline"><em>a</em></span> to <span class="math inline"><em>b</em></span>:<br />
<span class="math display"><em>F</em> = ∫<sub><em>a</em></sub><sup><em>b</em></sup><em>f</em>(<em>x</em>) <em>dx</em></span><br />
. Since the integral of a function <span class="math inline"><em>f</em>(<em>x</em>)</span> can be interpreted as the area below the function’s curve, we can pick up a random value <span class="math inline"><em>x</em> ∈ [<em>a</em>, <em>b</em>]</span> and evaluate the function at <span class="math inline"><em>x</em></span> and multiply the result by <span class="math inline">(<em>b</em> − <em>a</em>)</span>. If we plot the function’s curve and the result we will obtain a rectangle where <em>f(x)</em> is the height and <em>(b-a)</em> is the width, basically a crude approximation of the area under the curve. If we continue to evaluate the function at different random points between <em>a</em> and <em>b</em>, adding up the area of the rectangles and averaging the sum, the resulting number gets closer to the actual results of the integral.</p>
<p>Let’s consider an example in which the function we want to integrate is <span class="math inline"><em>f</em>(<em>x</em>) = sin <em>x</em></span> on interval <span class="math inline">[0, <em>π</em>]</span> and write some <strong>OCaml</strong> code. The function plot can be seen in Fig. 1.</p>
<figure>
<img src="../img/blog/integration-sinx-curve.png" alt="Fig. 1:sin(x) curve" /><figcaption>Fig. 1:sin(x) curve</figcaption>
</figure>
<p>We will create a new module <strong>MonteCarlo</strong> with the interface defined in the below snippet:</p>
<div id="cb1" class="sourceCode">
<div id="cb1" class="sourceCode">
<div class="sourceCode" id="cb1"><pre class="sourceCode ocaml"><code class="sourceCode ocaml"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">module</span> <span class="kw">type</span> MonteCarlo_type=<span class="kw">sig</span></a>
<a class="sourceLine" id="cb1-2" title="2">  <span class="kw">val</span> initializePRNG:<span class="dt">unit</span>-&gt;<span class="dt">unit</span></a>
<a class="sourceLine" id="cb1-3" title="3">  <span class="kw">val</span> getRandomNumber:<span class="dt">unit</span>-&gt;<span class="dt">float</span></a>
<a class="sourceLine" id="cb1-4" title="4">  <span class="kw">val</span> approximate:(<span class="dt">float</span>-&gt;<span class="dt">float</span>)-&gt;<span class="dt">float</span>-&gt;<span class="dt">float</span>-&gt;<span class="dt">int</span>-&gt;<span class="dt">int</span>-&gt;<span class="dt">float</span>-&gt;<span class="dt">float</span>  </a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">end</span></a></code></pre></div>
</div>
</div>
<p>We have a function <em>initializePRNG</em> which will initialize the pseudorandom number generator, <code>let initializePRNG ()=Random.self_init()</code>. <code>let getRandomNumber ()=Random.float 1.0</code> function will only generate a pseudorandom number distributed on <span class="math inline">[0, 1]</span>. Finally, the most interesting function, <em>approximate</em> receives 6 parameters as follow: <em>. First parameter is the function <span class="math inline"><em>f</em>(<em>x</em>)</span></em> . Second and third parameters are the limits <em>a</em> and <em>b</em>. <em>. Fourth parameter is the number of iterations.</em> . Fifth parameter is the current iteration *. Sixth parameter is the sumed value.</p>
<div id="cb2" class="sourceCode">
<div id="cb2" class="sourceCode">
<div class="sourceCode" id="cb2"><pre class="sourceCode ocaml"><code class="sourceCode ocaml"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">let</span> <span class="kw">rec</span> approximate f a b n index value=</a>
<a class="sourceLine" id="cb2-2" title="2">    <span class="kw">if</span> index=(n<span class="dv">-1</span>) <span class="kw">then</span></a>
<a class="sourceLine" id="cb2-3" title="3">      ((b-.a)/.(<span class="dt">float_of_int</span> index))*.value</a>
<a class="sourceLine" id="cb2-4" title="4">    <span class="kw">else</span></a>
<a class="sourceLine" id="cb2-5" title="5">      <span class="kw">let</span> randVal=getRandomNumber() <span class="kw">in</span></a>
<a class="sourceLine" id="cb2-6" title="6">      <span class="kw">let</span> inInterval=a+.randVal*.(b-.a) <span class="kw">in</span></a>
<a class="sourceLine" id="cb2-7" title="7">      <span class="kw">let</span> fVal=f inInterval <span class="kw">in</span></a>
<a class="sourceLine" id="cb2-8" title="8">      approximate f a b n (index+<span class="dv">1</span>) (value+.fVal)</a></code></pre></div>
</div>
</div>
<p>The complete <em>MonteCarlo</em> module is implemented bellow:</p>
<div id="cb3" class="sourceCode">
<div id="cb3" class="sourceCode">
<div class="sourceCode" id="cb3"><pre class="sourceCode ocaml"><code class="sourceCode ocaml"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">open</span> <span class="dt">Random</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">open</span> MonteCarlo_type</a>
<a class="sourceLine" id="cb3-3" title="3"></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="kw">module</span> MonteCarlo:MonteCarlo_type=<span class="kw">struct</span></a>
<a class="sourceLine" id="cb3-5" title="5">  <span class="kw">let</span> initializePRNG ()=<span class="dt">Random</span>.self_init()</a>
<a class="sourceLine" id="cb3-6" title="6">  <span class="kw">let</span> getRandomNumber ()=<span class="dt">Random</span>.<span class="dt">float</span> <span class="fl">1.0</span></a>
<a class="sourceLine" id="cb3-7" title="7">  </a>
<a class="sourceLine" id="cb3-8" title="8">  <span class="kw">let</span> <span class="kw">rec</span> approximate f a b n index value=</a>
<a class="sourceLine" id="cb3-9" title="9">    <span class="kw">if</span> index=(n<span class="dv">-1</span>) <span class="kw">then</span></a>
<a class="sourceLine" id="cb3-10" title="10">      ((b-.a)/.(<span class="dt">float_of_int</span> index))*.value</a>
<a class="sourceLine" id="cb3-11" title="11">    <span class="kw">else</span></a>
<a class="sourceLine" id="cb3-12" title="12">      <span class="kw">let</span> randVal=getRandomNumber() <span class="kw">in</span></a>
<a class="sourceLine" id="cb3-13" title="13">      <span class="kw">let</span> inInterval=a+.randVal*.(b-.a) <span class="kw">in</span></a>
<a class="sourceLine" id="cb3-14" title="14">      <span class="kw">let</span> fVal=f inInterval <span class="kw">in</span></a>
<a class="sourceLine" id="cb3-15" title="15">      approximate f a b n (index+<span class="dv">1</span>) (value+.fVal)</a>
<a class="sourceLine" id="cb3-16" title="16"><span class="kw">end</span></a></code></pre></div>
</div>
</div>
<p>Finally, to use the code we just need to define the function that we want to integrate and call approximate, as bellow:</p>
<div id="cb4" class="sourceCode">
<div id="cb4" class="sourceCode">
<div class="sourceCode" id="cb4"><pre class="sourceCode ocaml"><code class="sourceCode ocaml"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">open</span> MonteCarlo</a>
<a class="sourceLine" id="cb4-2" title="2"></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="kw">let</span> pi = <span class="fl">4.0</span> *. <span class="dt">atan</span> <span class="fl">1.0</span>;;</a>
<a class="sourceLine" id="cb4-4" title="4"><span class="kw">let</span> func (x:<span class="dt">float</span>)=<span class="dt">sin</span> x</a>
<a class="sourceLine" id="cb4-5" title="5"><span class="kw">let</span> () = </a>
<a class="sourceLine" id="cb4-6" title="6">  MonteCarlo.initializePRNG();</a>
<a class="sourceLine" id="cb4-7" title="7">  <span class="dt">print_float</span> (MonteCarlo.approximate func <span class="fl">0.0</span> pi <span class="dv">100000</span> <span class="dv">0</span> <span class="fl">0.0</span>)</a></code></pre></div>
</div>
</div>
<div class="header">
<a href="../blog.html">← Posts</a>
</div>
<div class="header">
<a href="../blog.html">← Posts</a>
</div>
<div class="header"> <a href="../blog.html">&larr; Posts</a> </div>
</body>
</html>
